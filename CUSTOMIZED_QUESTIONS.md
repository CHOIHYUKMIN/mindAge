# 연령·성별 맞춤형 질문 시스템 구현 완료

## 📋 개요
사용자의 **실물 나이**와 **성별**에 따라 **맞춤형 질문**을 제공하여 마음의 나이 계산의 정확도와 사용자 몰입도를 향상시키는 시스템을 구현했습니다.

---

## ✨ 주요 기능

### 1. 연령대별 질문 분류
| 연령대 | 코드명 | 나이 범위 | 질문 특징 |
|--------|--------|-----------|-----------|
| **10대** | `teen` | 10-19세 | 학교, SNS, 게임, 친구 관계 중심 |
| **20대** | `twenties` | 20-29세 | 커리어, 연애, 자기계발, 소비 패턴 중심 |
| **30대** | `thirties` | 30-39세 | 가족, 재테크, 건강, 일-가정 균형 중심 |
| **40대 이상** | `forties` | 40세 이상 | 은퇴 준비, 자녀 교육, 건강 관리, 취미 중심 |

### 2. 성별 맞춤 질문
각 연령대마다 **공통 질문** + **성별 특화 질문**으로 구성:
- **공통 질문 (common)**: 모든 성별에게 동일하게 제시
- **남성 질문 (male)**: 남성에게 더 관련성 높은 질문
- **여성 질문 (female)**: 여성에게 더 관련성 높은 질문
- **범용 질문 (universal)**: 연령·성별 무관한 보편적 질문

### 3. 가중치 시스템
각 질문에 `weight` 값을 부여하여 중요도 조절:
```javascript
{
    question: "시험 기간에 주로?",
    options: ["😅 벼락치기", "📖 계획적으로 공부", ...],
    weight: 1.2  // 10대에게 더 중요한 질문이므로 가중치 높음
}
```

---

## 🔧 구현 세부사항

### 파일 변경 사항

#### 1. **질문 데이터 구조 개편** (`js/i18n/*.js`)
**기존 구조** (배열):
```javascript
questions: [
    { question: "...", options: [...] },
    { question: "...", options: [...] }
]
```

**새 구조** (연령·성별 객체):
```javascript
questions: {
    teen: {
        common: [{ question, options, weight }, ...],
        male: [...],
        female: [...]
    },
    twenties: { ... },
    thirties: { ... },
    forties: { ... },
    universal: [...]  // 모든 연령·성별 공통
}
```

#### 2. **i18n.js 업데이트**
- `getQuestions(ageGroup, gender)` 메서드 추가
- 연령대와 성별에 맞는 질문 동적 선택
- 하위 호환성 유지 (기존 배열 형식도 지원)

```javascript
getQuestions(ageGroup = null, gender = null) {
    // 1. 연령대 결정 (기본값: twenties)
    // 2. 공통 질문 추가
    // 3. 성별 특화 질문 추가
    // 4. 범용 질문 추가
    // 5. 10개로 제한
}
```

#### 3. **app.js 로직 개선**
| 메서드 | 변경 내용 |
|--------|-----------|
| `getAgeGroup(age)` | 실물 나이 → 연령대 변환 (teen/twenties/thirties/forties) |
| `analyzeImage()` | 얼굴 분석 후 `ageGroup` 계산 및 저장 |
| `startQuestions()` | `i18n.getQuestions(ageGroup, gender)` 호출하여 맞춤형 질문 세트 생성 |
| `renderQuestion()` | `currentQuestionSet` 사용 (기존 `getQuestions()` 대신) |
| `selectOption()` | 가중치 적용: `score = baseScore * weight` |
| `restart()` / `changePhoto()` | `ageGroup`, `currentQuestionSet` 리셋 추가 |

#### 4. **HTML UI 개선** (`index.html`)
질문 섹션에 **맞춤형 질문 안내 배지** 추가:
```html
<span data-i18n="customQuestionNotice">
    당신의 연령·성별에 맞춘 질문입니다
</span>
```
- 다국어 지원 (`ko`: 당신의 연령·성별에 맞춘 질문입니다)
- 그라디언트 배경으로 시각적 강조

---

## 📊 질문 구성 예시

### 10대 남성의 경우:
1. **공통 질문 3개** (teen.common)
   - 주말 활동, SNS 사용, 시험 기간 습관
2. **남성 질문 2개** (teen.male)
   - 게임 빈도, 운동 빈도
3. **범용 질문 3개** (universal)
   - 음악 장르, 아침 루틴, 여행 계획
4. **추가 공통 질문 2개** (부족분 채우기)

**총 10개 질문**으로 구성

### 30대 여성의 경우:
1. **공통 질문 3개** (thirties.common)
   - 주말 활동, 친구 대화 주제, 스트레스 해소
2. **여성 질문 2개** (thirties.female)
   - 일-가정 균형, 자기계발
3. **범용 질문 3개** (universal)
4. **추가 공통 질문 2개**

---

## 🎯 기대 효과

| 효과 | 설명 |
|------|------|
| **정확도 향상** | 연령·성별에 맞는 질문으로 더 의미 있는 답변 수집 |
| **사용자 몰입도 증가** | "내 상황에 딱 맞는 질문"이라는 인식 → 성실한 답변 유도 |
| **데이터 품질 개선** | 관련성 높은 답변 → 마음의 나이 추정 신뢰도 상승 |
| **다국어 지원** | 한국어, 영어, 중국어 모두 동일한 구조로 맞춤형 질문 제공 |
| **확장성** | 새로운 연령대·성별 추가 용이 (예: 50대, 논바이너리) |

---

## 🧪 테스트 시나리오

### 1. 연령대별 테스트
- [ ] **10대 사진** 업로드 → teen 질문 세트 확인
- [ ] **25세 사진** 업로드 → twenties 질문 세트 확인
- [ ] **35세 사진** 업로드 → thirties 질문 세트 확인
- [ ] **45세 사진** 업로드 → forties 질문 세트 확인

### 2. 성별별 테스트
- [ ] **남성 얼굴** → 남성 특화 질문 포함 확인
- [ ] **여성 얼굴** → 여성 특화 질문 포함 확인

### 3. 다국어 테스트
- [ ] 언어를 **영어**로 변경 → 영어 맞춤형 질문 확인
- [ ] 언어를 **중국어**로 변경 → 중국어 맞춤형 질문 확인

### 4. 가중치 테스트
- [ ] 콘솔에서 `app.answers` 확인 → weight 값 적용 여부 확인
- [ ] 동일 답변 선택 시 가중치에 따라 점수 차이 확인

### 5. UI 테스트
- [ ] 질문 섹션 상단에 "맞춤형 질문" 배지 표시 확인
- [ ] 다국어 전환 시 배지 텍스트 변경 확인

---

## 🔍 디버깅 로그

개발자 콘솔에서 다음 로그 확인 가능:
```javascript
// 얼굴 분석 후
Age: 25, Gender: male, Age Group: twenties

// 질문 선택 후
Selected 10 questions for twenties male
```

---

## 📈 향후 개선 아이디어

### 1. 머신러닝 기반 가중치 최적화
- 실제 사용자 데이터 수집
- 회귀 모델로 각 질문의 최적 가중치 학습

### 2. 더 세분화된 연령대
- 50대, 60대 이상 추가
- 10대를 초등/중등/고등으로 세분화

### 3. 비이진 성별 지원
- `nonbinary`, `preferNotToSay` 옵션 추가
- 성별 선택 UI 제공 (얼굴 인식이 부정확할 경우)

### 4. 동적 질문 순서
- 답변 패턴에 따라 다음 질문 동적 선택
- 적응형 테스트 (Adaptive Testing) 구현

### 5. A/B 테스트
- 맞춤형 vs. 기본 질문 효과 비교
- 완료율, 평균 점수, 사용자 만족도 측정

---

## 📝 주의사항

### 1. 프라이버시
- 연령·성별 정보는 **로컬에만 저장**
- 서버 전송 없음
- UI에 "이 정보는 질문 맞춤을 위해서만 사용됩니다" 안내 권장

### 2. 얼굴 인식 실패 시
- `ageGroup`이 `null`일 경우 **twenties**로 폴백
- `gender`가 `null`일 경우 성별 특화 질문 제외

### 3. 하위 호환성
- 기존 배열 형식 질문도 계속 지원
- 점진적 마이그레이션 가능

---

## 🎉 결론

**연령·성별 맞춤형 질문 시스템**은 사용자 경험을 크게 향상시키고, 마음의 나이 계산의 정확도를 높이는 핵심 기능입니다. 

- ✅ **3개 언어** (한국어, 영어, 중국어) 모두 지원
- ✅ **4개 연령대** × **2개 성별** = 8가지 맞춤형 질문 세트
- ✅ **가중치 시스템**으로 질문 중요도 조절
- ✅ **하위 호환성** 유지

이제 사용자는 자신의 연령과 성별에 딱 맞는 질문을 받게 되어, 더욱 몰입감 있고 정확한 테스트 경험을 할 수 있습니다! 🚀
